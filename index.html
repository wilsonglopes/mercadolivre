<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Custo MercadoLivre + Gerador de EAN</title>
  <style>
    :root{--bg:#f4f6fb;--card:#fff;--accent:#0b61ff;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial; margin:0; background:linear-gradient(180deg,var(--bg),#eef2ff); color:#111}
    .container{max-width:980px;margin:28px auto;padding:20px}
    header{display:flex;align-items:center;gap:16px}
    h1{margin:0;font-size:20px}
    .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 6px 18px rgba(12,30,60,0.06);margin-top:18px}
    .grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    input[type="number"],input[type="text"],select{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9f2;font-size:15px}
    .full{grid-column:1/-1}
    .result{display:flex;gap:12px;align-items:center;justify-content:space-between}
    .big{font-size:22px;font-weight:700}
    .muted{color:var(--muted);font-size:13px}
    .row{display:flex;gap:8px}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:10px;font-weight:600;cursor:pointer}
    button.ghost{background:transparent;color:var(--accent);border:1px solid rgba(11,97,255,0.12)}
    footer{margin-top:14px;color:var(--muted);font-size:13px}
    @media(max-width:720px){.grid{grid-template-columns:1fr}.result{flex-direction:column;align-items:flex-start}}
    .small{font-size:12px;color:var(--muted)}
    .chip{display:inline-block;padding:6px 10px;background:#f1f6ff;color:#073ea6;border-radius:999px;font-weight:600}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="chip">MercadoLivre</div>
      <div>
        <h1>Calculadora de Custo e Lucro + Gerador de EAN</h1>
        <div class="small">Coloque os valores do seu an√∫ncio e veja o lucro l√≠quido e margem.</div>
      </div>
    </header>

    <div class="card">
      <div class="grid">
        <div>
          <label>EAN</label>
          <input type="text" id="ean" placeholder="Clique para gerar" readonly />
          <button type="button" id="genEan" style="margin-top:8px;background:#2ab7ca">üìã Gerar EAN</button>
        </div>
        <div>
          <label>Marca</label>
          <input type="text" id="marca" placeholder="Ex: HerbalVita" />
        </div>
      </div>
    </div>

    <div class="card">
      <form id="form">
        <div class="grid">
          <div>
            <label>Pre√ßo de venda (R$)</label>
            <input type="number" step="0.01" id="price" value="100" required />
          </div>

          <div>
            <label>Tipo de an√∫ncio</label>
            <select id="plan">
              <option value="premium" data-fee="17">Premium (17%)</option>
              <option value="classico" data-fee="13">Cl√°ssico (13%)</option>
              <option value="custom" data-fee="0">Personalizado</option>
            </select>
          </div>

          <div>
            <label>% Tarifa Mercado Livre</label>
            <input type="number" step="0.01" id="mlFeePercent" value="17" />
          </div>

          <div>
            <label>Custo do produto (R$)</label>
            <input type="number" step="0.01" id="cost" value="40" />
          </div>

          <div>
            <label>Frete total (R$)</label>
            <input type="number" step="0.01" id="freteTotal" value="25" />
          </div>

          <div>
            <label>Frete subsidiado pelo vendedor (R$)</label>
            <input type="number" step="0.01" id="freteSubs" value="13" />
          </div>

          <div>
            <label>Embalagem (R$)</label>
            <input type="number" step="0.01" id="embalagem" value="2" />
          </div>

          <div>
            <label>Outros custos fixos (R$)</label>
            <input type="number" step="0.01" id="outros" value="0" />
          </div>

          <div>
            <label>% Impostos (sobre venda)</label>
            <input type="number" step="0.01" id="impostosPercent" value="0" />
          </div>

          <div>
            <label>% Mercado Pago</label>
            <input type="number" step="0.01" id="mpPercent" value="4.99" />
          </div>

          <div>
            <label>Taxa fixa Mercado Pago (R$)</label>
            <input type="number" step="0.01" id="mpFixed" value="0.4" />
          </div>

          <div class="full">
            <label>Descri√ß√£o / Observa√ß√µes</label>
            <input type="text" id="obs" placeholder="ex: promo√ß√£o, frete gr√°tis parcial, etc" />
          </div>
        </div>

        <div class="card" style="margin-top:12px">
          <div class="result">
            <div>
              <div class="muted">Receita bruta</div>
              <div class="big" id="gross">R$ 0,00</div>
            </div>

            <div>
              <div class="muted">Lucro l√≠quido</div>
              <div class="big" id="net">R$ 0,00</div>
            </div>

            <div>
              <div class="muted">Margem l√≠quida</div>
              <div class="big" id="margin">0%</div>
            </div>
          </div>

          <div style="margin-top:12px;display:flex;gap:8px;flex-wrap:wrap">
            <button type="button" id="calc">Calcular</button>
            <button type="button" id="copy" class="ghost">Copiar resultado</button>
            <button type="button" id="reset" class="ghost">Resetar</button>
          </div>

          <div style="margin-top:12px" id="breakdown" class="small muted">---</div>
        </div>
      </form>
    </div>

    <footer>
      Para publicar no Netlify, salve como <strong>index.html</strong> e fa√ßa o deploy arrastando o arquivo. Agora com <strong>gerador autom√°tico de EAN v√°lidos</strong>!
    </footer>
  </div>

  <script>
    function fmt(v){return v.toLocaleString('pt-BR',{style:'currency',currency:'BRL'})}
    function pct(v){return (Math.round(v*100)/100).toFixed(2)+'%'}

    const priceEl=document.getElementById('price')
    const planEl=document.getElementById('plan')
    const mlFeePercentEl=document.getElementById('mlFeePercent')
    const costEl=document.getElementById('cost')
    const freteTotalEl=document.getElementById('freteTotal')
    const freteSubsEl=document.getElementById('freteSubs')
    const embalagemEl=document.getElementById('embalagem')
    const outrosEl=document.getElementById('outros')
    const impostosPercentEl=document.getElementById('impostosPercent')
    const mpPercentEl=document.getElementById('mpPercent')
    const mpFixedEl=document.getElementById('mpFixed')
    const grossEl=document.getElementById('gross')
    const netEl=document.getElementById('net')
    const marginEl=document.getElementById('margin')
    const breakdownEl=document.getElementById('breakdown')

    // Atualiza taxa ML
    planEl.addEventListener('change', ()=>{
      const opt = planEl.selectedOptions[0]
      const fee = Number(opt.dataset.fee)
      if(planEl.value !== 'custom') mlFeePercentEl.value = fee
    })

    // Bot√µes
    document.getElementById('calc').addEventListener('click', calcular)
    document.getElementById('reset').addEventListener('click', ()=>{
      document.getElementById('form').reset(); calcular();
    })
    document.getElementById('copy').addEventListener('click', ()=>{
      const text = `Pre√ßo: ${priceEl.value}\nLucro l√≠quido: ${netEl.textContent}\nMargem: ${marginEl.textContent}\n${breakdownEl.textContent}`
      navigator.clipboard.writeText(text).then(()=> alert('Resultado copiado!'))
    })

    // Fun√ß√£o principal de c√°lculo
    function calcular(){
      const price = Number(priceEl.value) || 0
      const mlPercent = Number(mlFeePercentEl.value) || 0
      const cost = Number(costEl.value) || 0
      const freteSubs = Number(freteSubsEl.value) || 0
      const embalagem = Number(embalagemEl.value) || 0
      const outros = Number(outrosEl.value) || 0
      const impostosPercent = Number(impostosPercentEl.value) || 0
      const mpPercent = Number(mpPercentEl.value) || 0
      const mpFixed = Number(mpFixedEl.value) || 0

      const tarifaML = price * (mlPercent/100)
      const mpFee = price * (mpPercent/100) + mpFixed
      const impostos = price * (impostosPercent/100)
      const receitaBruta = price
      const custosTotais = tarifaML + mpFee + freteSubs + cost + embalagem + outros + impostos
      const lucro = receitaBruta - custosTotais
      const margem = receitaBruta ? (lucro / receitaBruta) * 100 : 0

      grossEl.textContent = fmt(receitaBruta)
      netEl.textContent = fmt(lucro)
      marginEl.textContent = margem.toFixed(2)+'%'

      breakdownEl.innerHTML = `Tarifa ML (${mlPercent}%): ${fmt(tarifaML)}<br>Mercado Pago (${mpPercent}% + ${fmt(mpFixed)}): ${fmt(mpFee)}<br>Impostos (${impostosPercent}%): ${fmt(impostos)}<br>Frete: ${fmt(freteSubs)}<br>Custo: ${fmt(cost)}<br>Embalagem: ${fmt(embalagem)}<br>Outros: ${fmt(outros)}<br><strong>Total custos:</strong> ${fmt(custosTotais)}<br><strong>Lucro l√≠quido:</strong> ${fmt(lucro)} (${margem.toFixed(2)}%)`
    }

    // Gerador de EAN v√°lido (EAN-13)
    document.getElementById('genEan').addEventListener('click', ()=>{
      const ean = gerarEAN13()
      document.getElementById('ean').value = ean
    })

    function gerarEAN13(){
      let base = ''
      for(let i=0;i<12;i++) base += Math.floor(Math.random()*10)
      const check = calcularDigitoEAN(base)
      return base + check
    }

    function calcularDigitoEAN(base){
      let soma = 0
      for(let i=0;i<base.length;i++){
        const num = parseInt(base.charAt(i))
        soma += (i%2===0) ? num : num*3
      }
      const resto = soma % 10
      return resto === 0 ? 0 : 10 - resto
    }

    calcular()
  </script>
</body>
</html>
